<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Preenchimento Curr√≠culo Criativo</title>
    <style>
      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: "Inter", sans-serif;
        background: #f3f6fa;
        color: #1f2d5a;
      }

      body {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        background: #fff;
        border-radius: 16px;
        max-width: 1200px;
        width: 95%;
        padding: 40px 50px 60px 50px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 30px;
        max-height: 90vh;
        overflow-y: auto;
      }

      .intro {
        grid-column: span 2;
        text-align: center;
        margin-bottom: 25px;
      }

      .intro h1 {
        font-size: 2.4rem;
        color: #0a2e68;
        font-weight: 700;
        margin: 0 0 10px;
      }

      .intro p {
        font-size: 1.1rem;
        color: #5c667b;
        margin: 0;
      }

      .campo {
        display: flex;
        flex-direction: column;
      }

      .campo span {
        font-weight: 700;
        font-size: 1.1rem;
        color: #0a2e68;
        margin-bottom: 8px;
      }

      .campo input,
      .campo textarea {
        border: none;
        border-bottom: 2px solid #cbd1dc;
        background: transparent;
        padding: 10px 8px;
        font-size: 1rem;
        color: #333;
        font-family: "Inter", sans-serif;
        transition: all 0.3s ease;
        resize: vertical;
        min-height: 45px;
        border-radius: 8px 8px 0 0;
        box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.05);
      }

      .campo textarea {
        min-height: 85px;
      }

      .campo input::placeholder,
      .campo textarea::placeholder {
        color: #999;
      }

      .campo input:focus,
      .campo textarea:focus {
        outline: none;
        border-bottom-color: #0a2e68;
        background-color: #f8faff;
        box-shadow: 0 0 6px rgba(10, 46, 104, 0.3);
      }

      .botoes {
        grid-column: span 2;
        display: flex;
        justify-content: flex-end;
        margin-top: 25px;
      }

      button {
        background-color: #0a2e68;
        color: white;
        padding: 14px 32px;
        font-size: 1.2rem;
        font-weight: 700;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      button:hover {
        background-color: #083c9e;
      }

      #erro {
        grid-column: span 2;
        text-align: center;
        color: red;
        margin-top: 15px;
        font-weight: 700;
        font-size: 1rem;
      }

      @media (max-width: 768px) {
        .container {
          grid-template-columns: 1fr;
          padding: 30px 25px 40px 25px;
          max-height: none;
          overflow-y: visible;
        }
        .botoes {
          justify-content: center;
        }
      }

      /* Acessibilidade */
      #acessibilidade-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #026ab0;
        color: white;
        font-weight: bold;
        padding: 10px 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        z-index: 9999;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        transition: background-color 0.3s ease;
      }
      #acessibilidade-btn:hover {
        background-color: #004c87;
      }

      /* Modo alto contraste */
      .alto-contraste {
        background-color: #000 !important;
        color: #00ffff !important; /* azul-ciano para texto */
      }

      .alto-contraste .container {
        background-color: #111 !important;
      }

      .alto-contraste input,
      .alto-contraste textarea {
        background-color: #000 !important;
        color: #00ffff !important;
        border-bottom: 2px solid #00ffff !important;
      }

      .alto-contraste input::placeholder,
      .alto-contraste textarea::placeholder {
        color: #66ffff !important;
      }

      .alto-contraste .intro h1,
      .alto-contraste .campo span,
      .alto-contraste p,
      .alto-contraste #erro {
        color: #00ffff !important;
      }

      .alto-contraste button {
        background-color: #026ab0 !important;
        color: white !important;
        border: none !important;
      }

      .alto-contraste button:hover {
        background-color: #004c87 !important;
      }

      /* Fonte maior para acessibilidade */
      .fonte-grande {
        font-size: 120% !important;
      }

      .fonte-grande h1 {
        font-size: 2.8rem !important;
      }

      .fonte-grande span,
      .fonte-grande p,
      .fonte-grande input,
      .fonte-grande textarea {
        font-size: 1.3rem !important;
      }
    </style>
  </head>
  <body>
    <button id="acessibilidade-btn" aria-label="Ativar acessibilidade">
      ‚ôø Acessibilidade
    </button>

    <div class="container">
      <div class="intro">
        <h1>Vamos montar seu curr√≠culo ‚úçÔ∏è</h1>
        <p>
          Preencha com suas informa√ß√µes, como se estivesse se apresentando üòä
        </p>
      </div>

      <form
        onsubmit="event.preventDefault(); salvarDadosCriativo();"
        style="grid-column: span 2; display: contents"
      >
        <!-- Todos os campos originais -->
        <div class="campo">
          <span>Nome Completo:</span>
          <input
            type="text"
            id="nome"
            name="nome"
            placeholder="Digite seu nome completo"
          />
        </div>

        <div class="campo">
          <span>E-mail:</span>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Digite seu e-mail"
          />
        </div>

        <div class="campo">
          <span>Telefone:</span>
          <input
            type="text"
            id="telefone"
            name="telefone"
            placeholder="Ex: (34) 99999-9999"
          />
        </div>

        <div class="campo">
          <span>Resumo profissional:</span>
          <textarea
            id="resumo"
            name="resumo"
            rows="3"
            placeholder="Fale um pouco sobre sua trajet√≥ria"
          ></textarea>
        </div>

        <div class="campo">
          <span>Forma√ß√£o acad√™mica:</span>
          <textarea
            id="formacao"
            name="formacao"
            rows="3"
            placeholder="Ex: Ensino M√©dio, T√©cnico, Superior..."
          ></textarea>
        </div>

        <div class="campo">
          <span>Experi√™ncia profissional:</span>
          <textarea
            id="experiencia"
            name="experiencia"
            rows="3"
            placeholder="Suas experi√™ncias anteriores"
          ></textarea>
        </div>

        <div class="campo">
          <span>Habilidades:</span>
          <textarea
            id="habilidades"
            name="habilidades"
            rows="3"
            placeholder="Ex: Python, trabalho em equipe, comunica√ß√£o..."
          ></textarea>
        </div>

        <div class="campo">
          <span>Perfil pessoal:</span>
          <textarea
            id="perfil"
            name="perfil"
            rows="3"
            placeholder="Como voc√™ √©, pontos fortes, interesses..."
          ></textarea>
        </div>

        <div class="campo">
          <span>Idiomas (opcional):</span>
          <input
            type="text"
            id="idiomas"
            name="idiomas"
            placeholder="Ex: Ingl√™s, Espanhol..."
          />
        </div>

        <div class="campo">
          <span>LinkedIn (opcional)</span>
          <input
            type="text"
            id="linkedin"
            name="linkedin"
            placeholder="https://www.linkedin.com/in/seu-perfil"
          />
        </div>

        <div class="campo">
          <span>Portf√≥lio (opcional):</span>
          <input
            type="url"
            id="portfolio"
            name="portfolio"
            placeholder="Link do seu portf√≥lio ou site pessoal"
          />
        </div>

        <div class="botoes"><button type="submit">Gerar curr√≠culo</button></div>
        <div id="erro"></div>
      </form>
    </div>

    <script>
      const btn = document.getElementById("acessibilidade-btn");
      btn.addEventListener("click", () => {
        document.body.classList.toggle("alto-contraste");
        document.body.classList.toggle("fonte-grande");
      });

      function garantirHttps(url) {
        if (!url) return "";
        if (url.startsWith("http://") || url.startsWith("https://")) return url;
        return "https://" + url;
      }

      function salvarDadosCriativo() {
        const campos = [
          "nome",
          "email",
          "telefone",
          "resumo",
          "formacao",
          "experiencia",
          "habilidades",
          "perfil",
        ];
        const dados = {};
        let todosPreenchidos = true;

        campos.forEach((campo) => {
          const valor = document.getElementById(campo).value.trim();
          if (!valor) todosPreenchidos = false;
          dados[campo] = valor;
        });

        dados.idiomas = document.getElementById("idiomas")?.value.trim() || "";
        dados.linkedin = garantirHttps(
          document.getElementById("linkedin")?.value.trim() || ""
        );
        dados.portfolio = garantirHttps(
          document.getElementById("portfolio")?.value.trim() || ""
        );

        const mensagemErro = document.getElementById("erro");
        if (!todosPreenchidos) {
          mensagemErro.textContent =
            "‚ö†Ô∏è Por favor, preencha todos os campos antes de continuar.";
          return;
        }

        mensagemErro.textContent = "";

        fetch("/gerar_curriculo_criativo", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(dados),
        })
          .then((res) => {
            if (!res.ok) throw new Error("Erro na resposta do servidor");
            return res.text();
          })
          .then((htmlContent) => {
            const novaJanela = window.open("", "_blank");
            novaJanela.document.write(htmlContent);
            novaJanela.document.close();
            novaJanela.focus();
          })
          .catch((erro) => {
            console.error("Erro ao gerar curr√≠culo:", erro);
            alert("Ocorreu um erro ao gerar o curr√≠culo. Veja o console.");
          });
      }
    </script>
  </body>
</html>
